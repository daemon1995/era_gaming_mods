генерация - дупликация охраны
это из-за вольготного расчета connection counter на основе rmgMapItemVector (а не настройки шаблона) 00541630
00541BD1 плейсинг монстра на 1-2 тайла левее/правее по ширине, чем нужно (левее дороги)

генерация ширины прохода
0053C2C0 - hota hook - 
00540FB1 - hota hook - editing path between zones
нужно редактирование ширины прохода

генерация - более гармоничные размеры зон
0053C1C7 начиная отсюда, весь код до 73 строки сомнителен
0053C304 начиная отсюда, где-то тут происходит коррекция размера зон (возможно, тут 0053BB37)
где применяется random seed?
0053BB67 [ecx] = &X
0053BB71 eax = baseSize
0053BB9D ebp-0x14 (20) = delta

генерация объектов - запретить генерацию на дороге объектов и декора
00548780
H3RmgGroundTile
0x3 unsigned __int32 roadType : 3;

10E0 / 1E = 4320 / 30 = 144

генерация декора - уменьшить кол-во гор/деревьев
005320A0

генерация - зеленые деревья на снежной почве

генерация - вода на безводных темплейтах




описания существ в json - нет смысла с аметистом

плагин SadnessPower на АИ поведение

съезжает описание скиллов и спеллов командиров при их изменении
у знахаря, астрала, суккубки и огра отняли скилл
?? суккубка - при атаке шанс гипноза на 1 раунд
ии заклинания - берсерк

баг некромантии (см. ченжлог хоты) - сложно исправить, скорее всего, это сломает всю интеграцию с другими модами
мощь отца драконов в мейн модуле - упростить в сборке

существа:
дракон-голем
суккубка
ядовитое отродье
ледяной демон
улей
гаргантюа
царь драконов
гоблин-рыцарь

отвязка аметиста от текстовиков:
вынести cranim, 3 текста с хар-ками (crtrait0, crtraits, zcrtrait) в json, добавлять при чтении текстовика

аое выстрел: деструктор на указатель оригинального звука смерти
аое выстрел: функция shoot по гексу - расчет удачи - прыжок в функцию гога/лича

постэффект выстрелов гогов, элементалей шторма, злых глаз, элементалей льда, личей (???), титанов, гренадеров:
обсудить с raistlin

хинт в битве аметиста - попросить yugi вынести в amethyst.cfg

замена кучек ресурсов на мифрил - вынести в конфиг

хайхук loadcrtraits - изменять параметры монстров через json

городские врата

README.txt

интерфейс скиллов из Г4

расчет базовой ценности нычки в рмг диалоге (хз как это сделать)
Гильдия наёмников (тип 213) - отдельно в список генерации добавляется - в рмг плагин - ценность 100, частота 50, не больше 1 в зоне

rmg пандорок
rmg лавовых озер/деревьев и вообще декор (частота?)

жертвенник:
!!!кажется, это изменения вога!!!
баг - артефакты может жертвовать "плохой" герой
баг - войска может жертвовать "хороший" герой
баг - можно пожертвовать свитки, Грааль и боевые машины на Жертвенном Алтаре, если добавить артефакт, который можно пожертвовать
кнопка "положить все арты из сумы" - сделать чек на подтип
кнопка "положить все арты" - сделать чек на подтип
лкм по арту с запрещ. к жертве подтипом в инвентаре или рюкзаке - окно с текстом "нельзя это жертвовать"
кнопка "привести в жертву воинов" при отрисовке диалога - чек мировоззрения героя
кнопка "пожертвовать артефакты" при отрисовке диалога - чек мировоззрения героя

у старьевщика нельзя продать свитки, а у торговца в городе можно
логика для трансформатора скелетов и старьевщика
сделать невозможным продажу грааля

# prospector: сделать скрипт cpp - придется дописывать захват мельниц и садков
# oil rig: сделать скрипт cpp - придется дописывать захват мельниц и садков
# сборник на + опыт (тюрбан, кольчуга)
сопряжение - погребальная урна (есть в ера+)
hallelem.def в TUM - пример добавки дефа
hota creatures - сделать резист огненным птицам вместо иммуна к огню

выделить мод hota
https://download.h3hota.com/upd/changelogs/rus.txt

Возможные новые строения:
казначейство
дом ветеранов
торговец свитками
древо жизни

*******************************************************************************************
CLIMAX - enter водопой
EXPERNCE - клон LUCK????
FAERIE - enter колодец
FLAGMINE - enter шахта
GAZEBO - enter древо знаний/камень знаний/звёздное колесо/хижина ведьмы/беседка/лачуга отшельника/колизей магов
GENIE - enter мельница/погреб/повозка
GETPROTECTION - enter сад откровения (аааа-налеееееееей)
GRAVEYARD - enter склеп/могила воина
LIGHTHOUSE - enter обзорка
LUCK - enter мистический сад/фонтан удачи/пруд лебедей/домик фей/минеральный источник/старатель
MILITARY - enter рефьюга/нычка
MORALE - enter фонтан юности/флаг единства/буй
MYSTERY - enter жертвенник/wog-объект
NOMAD - enter арена/башня марлетто/лагерь наёмников
ROGUE - enter стандартный банк существ
STORE - enter таверна/конюшня/фабрика военной техники/водопой
TEMPLE - enter святыня с заклинанием
LOOPAREN - loop арена
LOOPFOUN - loop нычка водных элементов/фонтан молодости
LOOPGARD - loop сад откровения
LOOPLEAR - loop камень знаний
LOOPMERC - loop лагерь наёмников
LOOPMON2 - loop /городские врата
LOOPSANC - loop портал славы/храм лояльности
LOOPSWAR - loop башня марлетто/форт на холме
LOOPSTAR - loop звёздное колесо



####################################################################################################
#########################################################     144     ##############################
####################################################################################################

### Derrick - Скважина
avmoilpm.def 001111111111111111111111111111111111111111111111 100000000000000000000000000000000000000000000000 110111111111 100000000000 144 8 0 0

GENIE
LOOPDRRK

Derrick is an adventure map location that normally produces 1000 Gold in the first day of the week. However, the first week of the first month it only produces 500 Gold. A hero must visit the Derrick to receive the gold. This object is functionally identical to the Water Wheel, but themed for wasteland terrain.

Terrain: wasteland;
Value: 750;
Frequency: 30.

visit HD Mod = 500 голды сбоку
visited HD Mod = текст сбоку

visit = текст + 500 голды
visited = текст



### Warlock's Lab - Лаборатория Чернокнижника
avxtrmtw.def 100111111111111111111111111111111111111111111111 010000000000000000000000000000000000000000000000 110111111111 100000000000 144 9 0 0
avxtrmts.def 100111111111111111111111111111111111111111111111 010000000000000000000000000000000000000000000000 110111111111 000000001000 144 9 0 0

STORE
LOOPELAL

Warlock's Lab is an adventure map object that allows the player to transmute Mercury mercury, Sulfur sulfur, Crystal crystals and Gem gems into each other at a 1 to 1 ratio. It functions as much more efficient Trading Post, but only for precious resources.

Limit per zone: 1;
Terrain: snow, wasteland;
Value: 10000;
Frequency: 100.

диалог наподобие внешнего рынка



### Prospector - Старатель
avtprosp.def 000111111111111111111111111111111111111111111111 010000000000000000000000000000000000000000000000 110111111111 100000000000 144 10 0 0

LUCK
LOOPPROS

Prospector is an adventure map location, that can be visited with a hero to receive either 500 Gold or 5 Sulfur (chosen randomly) once a week.

Terrain: wasteland;
Value: 500;
Frequency: 30.

visit HD Mod = 500 голды/5 серы сбоку
visited HD Mod = текст сбоку

visit = текст + 500 голды/5 серы
visited = текст



####################################################################################################
#################################     145 - желтый тайл непроходимый    ############################
####################################################################################################

### Sea Barrel
AVAbrrlw.def 011111111111111111111111111111111111111111111111 100000000000000000000000000000000000000000000000 110111111111 000100000000 145 1 0 0

Sea Barrel is an adventure map object that can be gathered by a hero sailing in a boat. Sea Barrels can only be found on water, and they disappear after a hero has picked them up.

Terrain: water.
Value: 500.
Frequency of occurrence: 400.



### Jetsam
AVAcratw.def 011111111111111111111111111111111111111111111111 100000000000000000000000000000000000000000000000 110111111111 000100000000 145 2 0 0

Jetsam is an adventure map object that can be gathered by a hero sailing in a boat. Jetsams can only be found on water, and they disappear after a hero has picked them up.

Terrain: water.
Value: 500.
Frequency of occurrence: 600.



### Vial of Mana
AVAmnbtw.def 011111111111111111111111111111111111111111111111 100000000000000000000000000000000000000000000000 110111111111 000100000000 145 3 0 0

Vial of Mana is an adventure map object that can be gathered by a hero sailing in a boat. It grants 30, 40, 50 ,or 60 spell points, then disappears. If the resulting amount of spell points exceeds the normal cap for the hero, only half the extra points will be granted.

Terrain: water.
Value: 3000.
Frequency of occurrence: 50



####################################################################################################
#########################################################     146     ##############################
####################################################################################################

### Altar of Mana
AVXMALTW.def 001111111011111111111111111111111111111111111111 110000000000000000000000000000000000000000000000 110111111111 000100000000 146 2 0 0

Altar of Mana is an adventure map location that can only appear on Water. Heroes may sacrifice creatures at the altar in exchange for spell points, up to 4x their normal cap. Each sacrificed creature gives (AI Value)/80 mana points.

Limit per zone: 1.
Terrain: water.
Value: 100.
Frequency of occurrence: 20.



#### Town Gate - Городские Врата
avxtwngt.def 000111111111111111111111111111111111111111111111 010000000000000000000000000000000000000000000000 110011111111 110011111111 146 3 0 0

MYSTERY
LOOPMON2

Town Gate is an adventure map object that allows a visiting hero to teleport to any allied town. This does not cost any additional movement points.

Limit per zone: 1.
Terrain: any dry land.
Value: 10000.
Frequency of occurrence: 20

работает как диалог городского портала (см erm скрипт на wog-объект)
ф-ия в иде:


####################################################################################################
#########################################################          ##############################
####################################################################################################

### Cannon Yard
avcnbksm.def 000111111011111111111111111111111111111111111111 100000000000000000000000000000000000000000000000 110111111111 110011111111 106 1 0 0

Cannon Yard is an Adventure map object that sells Cannon Cannons to visiting heroes for 4000 Gold.


################################ Добавлено:

+ Форт на Холме 35/1 - диалог
+ Форт на Холме ai - сделан переписанной функцией расчета ценности форта на холме (005292EC)

+ Толкователь Снов 141/0 - сообщение без условий
+ Толкователь Снов ai - сделан переписанной функцией расчета ценности древа знаний (0052BB89) и камня опыта (00529833)
Толкователь Снов: быстрое сообщение посещения - значок опыта и кол-во (это надо знать HD-mod)

+ Могила 141/1 - сообщение без условий (надо копать для эффекта)
Могила  ai - сделана минимальная логика (надо дополнить необходимостью для АИ артефактов и золота)

+ Храм Лояльности 144/0 - сообщение без условий
+ Храм Лояльности ai - сделан вызовом функции храма (005281D0) + доп проверками на кол-во мировоззрений перед

+ Преобразователь Скелетов 144/1 - диалог
Преобразователь Скелетов: ai

+ Колизей Магов 144/2 - выбор без условий
+ Колизей Магов ai - сделан переписанной функцией расчета ценности арены (00528571)

+ Водопой 144/3 - вопрос без условий
+ Водопой ai - сделан переписанной функцией расчета ценности лебединого озера (00528A4C)
Водопой: OnEveryDay - не обновляются мув поинты мгновенно - НУЖНАЯ ФУНКЦИЯ НАХОДИТСЯ В ФУНКЦИИ ЗАКРЫТИЯ ОКНА ГЕРОЯ

+ Минеральный Источник 144/4 - сообщение без условий
+ Минеральный Источник: ai - сделан переписанной функцией расчета ценности оазиса (0052A6C0)
Минеральный источник: кастомный бонус вместо "до следующей битвы" - 0044BE90
Минеральный источник: быстрое сообщение посещения - значок удачи (это надо знать HD-mod)

+ Лачуга Отшельника 144/5 - сообщение с условием
+ Лачуга Отшельника ai - сделан переписанной функцией расчета ценности хижины ведьмы (0052BDE0)
Лачуга Отшельника: быстрое сообщение посещения - значок скилла (это надо знать HD-mod)

+ Беседка 144/6 - вопрос с условием
+ Беседка ai - сделан переписанной функцией расчета ценности древа знаний (0052BB89) и камня опыта (00529833)

+ Старьёвщик 144/7 - диалог
Старьёвщик ai

+ Проводник 144/11 - сообщение без условий
+ Проводник ai - сделан переписанной функцией расчета ценности конюшни (0052AFA0)

+ Древняя Лампа 145/0 - нычка с исчезновением
+ Древняя Лампа ai - сделан вызовом функции рефьюги (0052ABF0)

+ Обсерватория 146/1 - сообщение без условий
+ Обсерватория ai - сделан переписанной функцией расчета ценности конюшни (0052AFA0)



###########################################################################################################

typedef unsigned char BYTE; // 1 byte
typedef unsigned short WORD; // 2 byte
typedef unsigned long DWORD; // 4 byte
typedef unsigned long long QWORD; // 8 byte (или 16???)



новые типы прописывать тут:
ObjectsExtender.h, строка 6
RMGObjectsEditor.cpp, строка 770
RMG_SettingsDlg.cpp, строка 1612

новые классы прописывать тут:
pch.h
dllmain.cpp, строка 74

непроходимость желтого тайла проставляется тут:
ObjectsExtender.cpp, строка 255

исключаются типы из генерации тут:
RMGObjectsEditor.cpp, строка 174



Водные объекты wog fix lite:
AVXl1sh0.def 011111111111111111111111111111111111111111111111 100000000000000000000000000000000000000000000000 111111111 011111111 88 0 0 0
Watersp1.def

AVXl2sh0.def 011111111111111111111111111111111111111111111111 100000000000000000000000000000000000000000000000 111111111 011111111 89 0 0 0
Watersp2.def

AVXl3sh0.def 011111111111111111111111111111111111111111111111 100000000000000000000000000000000000000000000000 111111111 011111111 90 0 0 0
Watersp3.def

Watersp4.def

AvXRedW.def 011111111111111111111111111111111111111111111111 100000000000000000000000000000000000000000000000 111111111 010111111 58 0 0 0
AVXreds0.def 011111111111111111111111111111111111111111111111 100000000000000000000000000000000000000000000000 111111111 000001000 58 0 0 0
WaterOb.def

Waterpost.def - ???
Wtrpost.def - ???

Водные объекты остальное:
+ посмотреть еще университет и остальное (см.adventure objects)

доработка водной тюрьмы и таверны - герой должен помещаться в лодку








